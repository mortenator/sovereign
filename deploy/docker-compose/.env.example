# ═══════════════════════════════════════════════════════════════════════════════
# Sovereign Deploy — Environment Variables
# Copy this file to .env and fill in all values before starting the stack.
# Run `scripts/setup.sh` to generate this automatically.
#
# ⚠️  Never commit the .env file to version control.
# ⚠️  All passwords must be changed from these example values before deployment.
# ═══════════════════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────
# Domain Configuration
# ───────────────────────────────────────────────

# Your public domain name. Used by Traefik for routing and TLS.
# Production: your.domain.com
# Development: localhost
DOMAIN=sovereign.example.com

# ───────────────────────────────────────────────
# TLS / Let's Encrypt
# ───────────────────────────────────────────────

# Email address for Let's Encrypt certificate notifications.
# Required for production TLS. Must be a valid email.
ACME_EMAIL=admin@sovereign.example.com

# ───────────────────────────────────────────────
# PostgreSQL — Primary Database
# ───────────────────────────────────────────────

# Password for the 'sovereign' PostgreSQL superuser (used for DB admin and init only).
# The web application does NOT connect with this password — see SOVEREIGN_APP_DB_PASSWORD.
# Generate with: openssl rand -base64 32
POSTGRES_PASSWORD=__RUN_openssl_rand_base64_32__

# Password for the 'sovereign_app' non-superuser role used by the web application.
# This role has no superuser privileges — limits blast radius of SQL injection.
# Generate with: openssl rand -base64 32
SOVEREIGN_APP_DB_PASSWORD=__RUN_openssl_rand_base64_32__

# ───────────────────────────────────────────────
# Redis — Cache + Session Store
# ───────────────────────────────────────────────

# Redis AUTH password. Applied to all Redis connections.
# Generate with: openssl rand -base64 32
REDIS_PASSWORD=__RUN_openssl_rand_base64_32__

# ───────────────────────────────────────────────
# MinIO — S3-Compatible Object Storage
# ───────────────────────────────────────────────

# Root user for MinIO (acts as S3 access key).
# Min 3 characters.
MINIO_ROOT_USER=sovereign

# Root password for MinIO (acts as S3 secret key).
# Min 8 characters. Generate with: openssl rand -base64 32
MINIO_ROOT_PASSWORD=__RUN_openssl_rand_base64_32__

# AWS region label for MinIO (informational — keeps EU data residency clear).
# For EU deployments, use eu-central-1 (Frankfurt) or eu-west-1 (Ireland).
MINIO_REGION=eu-central-1

# ───────────────────────────────────────────────
# Keycloak — Identity & Access Management
# ───────────────────────────────────────────────

# Keycloak admin console username.
KEYCLOAK_ADMIN_USER=admin

# Keycloak admin console password. Change immediately after first login.
# Generate with: openssl rand -base64 32
KEYCLOAK_ADMIN_PASSWORD=__RUN_openssl_rand_base64_32__

# Password for the 'keycloak' PostgreSQL database user.
# Generate with: openssl rand -base64 32
KEYCLOAK_DB_PASSWORD=__RUN_openssl_rand_base64_32__

# OIDC client secret for the sovereign-web client registered in Keycloak.
# Generated automatically by setup.sh. Must match Keycloak realm configuration.
# Generate with: openssl rand -hex 32
KEYCLOAK_CLIENT_SECRET=__RUN_openssl_rand_hex_32__

# ───────────────────────────────────────────────
# OnlyOffice Document Server
# ───────────────────────────────────────────────

# Password for the 'onlyoffice' PostgreSQL database user.
# Generate with: openssl rand -base64 32
ONLYOFFICE_DB_PASSWORD=__RUN_openssl_rand_base64_32__

# JWT secret used to sign document access tokens.
# MUST be at least 32 characters. MUST match the value used by the web app.
# Generate with: openssl rand -hex 32
ONLYOFFICE_JWT_SECRET=__RUN_openssl_rand_hex_32__

# ───────────────────────────────────────────────
# Sovereign Web Application
# ───────────────────────────────────────────────

# Docker image tag for the web frontend.
# Use a specific version tag in production (e.g., v1.2.3).
# Use 'latest' only for development.
WEB_IMAGE_TAG=latest

# ───────────────────────────────────────────────
# Email / SMTP (Optional)
# Used for Keycloak password reset, invitations, and notifications.
# ───────────────────────────────────────────────

SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@sovereign.example.com

# SMTP TLS mode: STARTTLS (587) or SSL (465)
SMTP_TLS_MODE=STARTTLS

# ───────────────────────────────────────────────
# Backup Configuration
# Used by scripts/backup.sh
# ───────────────────────────────────────────────

# S3-compatible endpoint for backups (can be MinIO, AWS S3, Scaleway, etc.)
# Leave empty to skip remote backup upload.
BACKUP_S3_ENDPOINT=
BACKUP_S3_BUCKET=sovereign-backups
BACKUP_S3_ACCESS_KEY=
BACKUP_S3_SECRET_KEY=
BACKUP_S3_REGION=eu-central-1

# Local backup retention in days (older backups are deleted).
BACKUP_RETENTION_DAYS=30

# ───────────────────────────────────────────────
# Data Residency (Informational)
# For compliance audit reports — does not affect runtime behaviour.
# ───────────────────────────────────────────────

# ISO 3166-1 alpha-2 country code where data is physically stored.
DATA_REGION=EU-DE

# Deployment environment label (production / staging / development).
ENVIRONMENT=production
